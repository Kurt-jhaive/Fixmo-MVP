<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
  <label>Province / District</label>
  <select id="provinceSelect"></select>
</div>

<div>
  <label>City / Municipality</label>
  <select id="citySelect"></select>
</div>

<div>
  <label>Barangay</label>
  <select id="barangaySelect"></select>
</div>

<div>
  <label>Address Label</label>
  <input type="text" id="addressLabelInput" placeholder="Street name, Building, etc." />
</div>

</body>
<script>
    let locationData;

async function loadNCRData() {
  const response = await fetch('src\public\assets\locationdetails.json');
  const json = await response.json();
  locationData = json.NCR.province_list;
  populateProvinces();
}

function populateProvinces() {
  const provinceSelect = document.getElementById('provinceSelect');
  provinceSelect.innerHTML = '<option value="">Select Province</option>';

  Object.keys(locationData).forEach(province => {
    const option = document.createElement('option');
    option.value = province;
    option.textContent = province;
    provinceSelect.appendChild(option);
  });

  provinceSelect.addEventListener('change', handleProvinceChange);
}

function handleProvinceChange(e) {
  const selectedProvince = e.target.value;
  const cities = locationData[selectedProvince]?.municipality_list || {};

  const citySelect = document.getElementById('citySelect');
  citySelect.innerHTML = '<option value="">Select City/Municipality</option>';

  Object.keys(cities).forEach(city => {
    const option = document.createElement('option');
    option.value = city;
    option.textContent = city;
    citySelect.appendChild(option);
  });

  document.getElementById('barangaySelect').innerHTML = '<option value="">Select Barangay</option>';
  citySelect.addEventListener('change', () => handleCityChange(cities));
}

function handleCityChange(cities) {
  const selectedCity = document.getElementById('citySelect').value;
  const barangays = cities[selectedCity]?.barangay_list || [];

  const barangaySelect = document.getElementById('barangaySelect');
  barangaySelect.innerHTML = '<option value="">Select Barangay</option>';

  barangays.forEach(brgy => {
    const option = document.createElement('option');
    option.value = brgy;
    option.textContent = brgy;
    barangaySelect.appendChild(option);
  });
}

// Call this on page load
loadNCRData();

function getFullAddress() {
  const province = document.getElementById('provinceSelect').value;
  const city = document.getElementById('citySelect').value;
  const barangay = document.getElementById('barangaySelect').value;
  const label = document.getElementById('addressLabelInput').value;

  return `${label}, ${barangay}, ${city}, ${province}, Metro Manila`;
}
</script>
</html>